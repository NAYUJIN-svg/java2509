package com.nyg;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class CURDClass {

	public CURDClass() {

		// Read테이블 - select
		selectTable();
		// Creat테이블 - create table
		createTable();

//	// Update테이블 - update table
//		updateTable();
//		
//		
//	
//	// Delete테이블만의 row 삭제 - 
//		deleteUser();
//		
//	// insert
//		insertUser();

	}

	private void selectTable() {
		// TODO Auto-generated method stub
		String sql = "show tables";
		Connection conn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;

		try {
			conn = DBConnection.getConnection();
			pstmt = conn.prepareStatement(sql);
			rs = pstmt.executeQuery();
			System.out.println("------employees 데이터베이스내의 테이블을 확인 ------");

			while (rs.next()) {

				String talName2 = rs.getString(1);
				System.out.println("[" + talName2 + "]");
			}
		} catch (SQLException e) {

			e.printStackTrace();
		} finally {
			DBConnection.close(rs, conn, pstmt);
		}

	}

	private void createTable() {
		String sql = "create table if not exists users(" + "	id varchar(50), \r\n" + "	name varchar(100)\r\n"
				+ ")";
		Connection conn = null;
		PreparedStatement pstmt = null;

		try {

			conn = DBConnection.getConnection();
			stmt = conn.createStatement();
			stmt.execute(sql);
			System.out.println("users 테이블 생성 완료");
		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			DBConnection.close(stmt, conn);
		}
	}

}
